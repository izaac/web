<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
    <meta name="google" value="notranslate">


    <title>CodePen - Pomodoro Clock on React.js</title>



    <link rel='stylesheet prefetch' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css'>
    <link rel="stylesheet prefetch" href='https://fonts.googleapis.com/css?family=Pacifico|Open+Sans|Montserrat'>

        <style>
      /*@import url(http://fonts.googleapis.com/css?family=Pacifico|Open+Sans:300);*/
* {
  margin: 0;
}

body {
  background: #333;
  color: #fff;
}

#title-app {
  font-family: 'Pacifico';
  font-size: 5em;
}

#main {
  margin-top: 50px;
}

#timer:hover {
  cursor: pointer;
}

#timer {
  position: relative;
}

.btn-style {
  color: #fff;
  background-color: transparent;
  border: transparent;
  font-size: 3em;
}

.btn-style:hover {
  background-color: transparent;
  border: transparent;
  color: #808080;
}

.btn-style:active,
.btn-style:focus {
  outline: none !important;
  border: 0 !important;
  box-shadow: none !important;
  background-color: transparent;
}

.btn-style:active:focus {
  background-color: transparent !important;
}

.btn-style:active {
  color: #fff;
}

.btn-style:focus {
  color: #808080;
}

.btn-style[disabled] {
  color: transparent;
  background-color: transparent;
}

.btn-style[disabled]:hover {
  color: transparent;
  background-color: transparent;
}

.state-time {
  font-size: 2.5em;
  vertical-align: middle;
}

.state {
  text-transform: uppercase;
  font-size: 1.5em;
}

.inner-wrap-timer {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 100%;
  padding-top: 180px;
}

#draw-cirlce {
  position: absolute;
  left: 0;
  top: 0;
}

#content {
  margin-top: 10px;
  padding-top: 100px;
}

#title-state {
  font-size: 3.5em;
}

#curr-time {
  font-size: 3em;
}

    </style>




  </head>

  <body>

    <div class="container"></div>

    <script src='https://fb.me/react-0.14.6.js'></script>
<script src='https://fb.me/react-dom-0.14.6.js'></script>

        <script>
      /**
 * Creating Pomodoro App
 */
'use strict';

var PomodoroApp = React.createClass({
    displayName: 'PomodoroApp',

    // default values
    getInitialState: function getInitialState() {
        return {
            session: 25,
            'break': 5,
            timer: 25 * 60,
            isSessionNow: true,
            isPaused: false,
            eAngle: 0,
            isUpdated: false
        };
    },

    updateStats: function updateStats(newTime, token, didUpdate) {

        if (token === 'break') {
            this.setState({
                'break': newTime
            });

            if (!this.state.isSessionNow) {
                this.setState({
                    timer: newTime * 60,
                    isUpdated: didUpdate
                });
            }
        }

        if (token === 'session') {
            this.setState({
                session: newTime
            });

            if (this.state.isSessionNow) {
                this.setState({
                    timer: newTime * 60,
                    isUpdated: didUpdate
                });
            }
        }
    },

    // starts the Pomodoro Timer
    startPomodoro: function startPomodoro() {

        // timer according session or break
        var timer;
        // audio links
        var wav = 'http://www.oringz.com/oringz-uploads/sounds-917-communication-channel.mp3';
        var audio = new Audio(wav);

        var canvas = document.getElementById('draw-circle');
        var context = canvas.getContext('2d');
        var centerX = canvas.width / 2;
        var centerY = canvas.height / 2;
        var radius = 200;
        var offset;

        if (this.state.isSessionNow) {
            offset = 2 * Math.PI / (this.state.session * 60);
            context.strokeStyle = '#00FF00';

            if (this.state.timer > 0) {
                timer = this.state.timer;
            } else {
                timer = this.state.session * 60;
            }
        } else {
            offset = 2 * Math.PI / (this.state['break'] * 60);
            context.strokeStyle = '#ff0000';

            if (this.state.timer > 0) {
                timer = this.state.timer;
            } else {
                timer = this.state['break'] * 60;
            }
        }

        // if we time changed redraw canvas
        if (this.state.isUpdated) {
            context.clearRect(0, 0, canvas.width, canvas.height);
            this.setState({
                eAngle: 0
            });
        }

        // timer starting
        if (!this.state.isPaused) {
            this.state.interval = setInterval((function () {
                // timer not ended
                if (--timer >= 0) {

                    context.beginPath();
                    context.arc(centerX, centerY, radius, 1.5 * Math.PI, 1.5 * Math.PI + this.state.eAngle, false);
                    context.lineWidth = 3;
                    context.stroke();

                    this.setState({
                        timer: timer,
                        eAngle: this.state.eAngle + offset
                    });
                }
                // timer ended
                else {
                        // play audio
                        audio.play();
                        // change state
                        this.setState({
                            isSessionNow: !this.state.isSessionNow,
                            isPaused: false,
                            eAngle: 0
                        });
                        // clear interval
                        clearInterval(this.state.interval);
                        // clear canvas
                        context.clearRect(0, 0, canvas.width, canvas.height);
                        // restart pomodoro
                        this.startPomodoro();
                    }
            }).bind(this), 25);
        } else {
            clearInterval(this.state.interval);
        }

        this.setState({
            isPaused: !this.state.isPaused,
            isUpdated: false
        });
    },

    // display time in minutes and seconds
    displayTime: function displayTime() {
        var mins = parseInt(this.state.timer / 60);
        var secs = parseInt(this.state.timer % 60);

        mins = mins < 10 ? "0" + mins : mins;
        secs = secs < 10 ? "0" + secs : secs;

        return mins + ':' + secs;
    },

    // render components of ne the page
    render: function render() {

        return React.createElement(
            'div',
            { id: 'main', className: 'text-center' },
            React.createElement(
                'h1',
                { id: 'title-app' },
                'Pomodoro Clock'
            ),
            React.createElement(
                'div',
                { id: 'content' },
                React.createElement(
                    'div',
                    { className: 'row' },
                    React.createElement(Widget, { onTimeChanged: this.updateStats, sessOrBreakTime: this.state['break'],
                        token: 'break', isActive: this.state.isPaused
                    }),
                    React.createElement(Widget, { onTimeChanged: this.updateStats, sessOrBreakTime: this.state.session,
                        token: 'session', isActive: this.state.isPaused
                    })
                ),
                React.createElement(
                    'div',
                    { id: 'timer', onClick: this.startPomodoro, className: 'center-block' },
                    React.createElement('canvas', { id: 'draw-circle', width: '500', height: '500' }),
                    React.createElement(
                        'div',
                        { className: 'inner-wrap-timer' },
                        React.createElement(
                            'h2',
                            { id: 'title-state' },
                            this.state.isSessionNow ? 'Session' : 'Break'
                        ),
                        React.createElement(
                            'div',
                            { id: 'curr-time' },
                            this.displayTime()
                        )
                    )
                )
            )
        );
    }
});

/**
 * Creating Widget
 */
var Widget = React.createClass({
    displayName: 'Widget',

    getInitialState: function getInitialState() {
        return {
            sessOrBreakTime: this.props.sessOrBreakTime,
            token: this.props.token,
            isUpdated: this.props.isUpdated
        };
    },

    handleTimeUp: function handleTimeUp() {
        this.updateState(this.state.sessOrBreakTime + 1);
    },

    handleTimeDown: function handleTimeDown() {
        this.updateState(this.state.sessOrBreakTime - 1);
    },

    updateState: function updateState(newTime) {

        var updateTime = newTime;
        // max time in mins 60
        var max = 60;
        // min time in mins 1
        var min = 1;

        // did update time
        var isUpdated = true;

        if (updateTime > max) {
            updateTime = max;
        } else if (updateTime < min) {
            updateTime = min;
        }

        //
        this.setState({
            sessOrBreakTime: updateTime,
            eAngle: 0
        });

        this.props.onTimeChanged(updateTime, this.state.token, isUpdated);
    },

    // render components of ne the page
    render: function render() {
        return React.createElement(
            'div',
            { id: this.props.token, className: 'col-xs-6' },
            React.createElement(
                'h5',
                { className: 'state' },
                this.props.token
            ),
            React.createElement(
                'button',
                { onClick: this.handleTimeDown,
                    disabled: this.props.isActive,
                    className: 'btn btn-default btn-style' },
                '-'
            ),
            React.createElement(
                'span',
                { className: 'state-time' },
                this.state.sessOrBreakTime,
                ' mins'
            ),
            React.createElement(
                'button',
                { onClick: this.handleTimeUp,
                    disabled: this.props.isActive,
                    className: 'btn btn-default btn-style' },
                '+'
            )
        );
    }
});

ReactDOM.render(React.createElement(PomodoroApp, null), document.querySelector('.container'));
      //@ sourceURL=pen.js
    </script>




  </body>
</html>
